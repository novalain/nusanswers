<!DOCTYPE html>
<html lang="en">
	<head>
		<script src="http://code.jquery.com/jquery-2.2.0.min.js"></script>
	</head>
	
	
	<body>
		<!--

		Submit New Questions

		-->

		<h3>Submit New Questions</h3>

		<form id="qn_form" method="post">
			Title<br>
			<input id="title" type="text"><br>
			Content<br>
			<textarea id ="content" rows="10" cols="30"></textarea>
			<br/>
			<button id="submit" type="button">Submit</button>
			<br/>
			<text id="msg"></text>
		</form>
		<script type="text/javascript">
			$(document).ready(function(){
				$("#submit").click(function(){
					var title = $("#title").val();
					var content = $("#content").val();
					
					//if(title.length != 0 && content.length !=0){
						$.ajax({
							url: "questions.php",
							data: {
								"cmd" : "new_qn", 
								"user_id" : 1,
								"title" : title,
								"content" : content
							},
							type: "POST",
							error: function() {
								$("#msg").text("fail");
							},
							success: function(data){
								$("#msg").text(data);
							}	
						});
					//}else{
					//	$("#msg").text("Blank 'Title' or 'Content'");
					//}
					
					
					
				});
			});
		</script>
		<hr/>

		<!--

		Update Score or View_Count

		-->

		<form>
			ID<br/>
			<input id="id" type="text"><br><br>
			Update Score<br/>
			<input id="score" type="text"><button id="submit_score" type="button">Update Score</button><br>
			<br>
			Update View Count<br/>
			<input id="view" type="text"><button id="submit_view" type="button">Update View</button><br>
			<text id="msg_update"></text>
		</form>

		<script type="text/javascript">
			$(document).ready(function(){
				$("#submit_score").click(function(){
					var id = $("#id").val();
					var score = $("#score").val();

					$.ajax({
						url: "questions.php",
						data: {
							"cmd" : "update_score",
							"id" : id,
							"score" : score
						},
						type: "POST",
						error: function() {
							$("#msg_update").text("fail");
						},
						success: function(data){
							$("#msg_update").text(data);
						}	
					});
				});

				$("#submit_view").click(function(){
					var id = $("#id").val();
					var view = $("#view").val();

					$.ajax({
						url: "questions.php",
						data: {
							"cmd" : "update_view",
							"id" : id,
							"view_count" : view
						},
						type: "POST",
						error: function() {
							$("#msg_update").text("fail");
						},
						success: function(data){
							$("#msg_update").text(data);
						}	
					});
				});
			});
		</script>

		<hr>

		<!--

		Show Trending Post

		-->

		<style type="text/css">
			table, th, td {
    			border: 1px solid black;
    			border-collapse: collapse;
			}
		</style>
		<h3>Show trending post</h3>
		<table id="trend"  style="width:100% ">
			<thead>
				<th>id</th>
				<th>user_id</th>
				<th>title</th>
				<th>content</th>
				<th>score</th>
				<th>view_count</th>
				<th>created_at</th>
				<th>updated_at</th>
			</thead>
			<tbody id="tbl_body">
			</tbody>
		<table>
		<button id="view_db" type="button">Show Questions DB</button>
		<br/>
		<text id="msg_view"></text>


		<script type="text/javascript">
			$(document).ready(function(){
				$("#view_db").click(function(){
					$.ajax({
						url: "questions.php",
						data: {
							"cmd" : "trending" 
						},
						type: "POST",
						dataType: "json",
						error: function() {
							$("#msg_view").text("fail");
						},
						success: function(data){
							var table_content = "";
							for(var i=0; i<data.length; i++){
								table_content += (
									"<tr>" +
									"<td>" + data[i].id + "</td>" +
									"<td>" + data[i].user_id + "</td>" +
									"<td>" + data[i].title + "</td>" +
									"<td>" + data[i].content + "</td>" +
									"<td>" + data[i].score + "</td>" +
									"<td>" + data[i].view_count + "</td>" +
									"<td>" + data[i].created_at + "</td>" +
									"<td>" + data[i].updated_at+ "</td>" +
									"/tr"
								);
							}
							$("#tbl_body").html(table_content);
						}	
					});
				});
			});
		</script>
		<hr>

		<!--

		Delete row using 'id'

		-->
		<form>
			ID to be deleted<br/>
			<input id="delete_id" type="text"><br>
			<button id="delete" type="button">Delete</button><br>
			<text id="msg_delete"></text>
		</form>

		<script type="text/javascript">
			$(document).ready(function(){
				$("#delete").click(function(){
					var id = $("#delete_id").val();

					$.ajax({
						url: "questions.php",
						data: {
							"cmd" : "delete",
							"id" : id
						},
						type: "POST",
						error: function() {
							$("#msg_delete").text("Fail to excute delete");
						},
						success: function(data){
							$("#msg_delete").text(data);
						}
					});
				});
			});
		</script>

		<hr>

	</body>
</html>